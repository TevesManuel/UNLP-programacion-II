procesos
 
  proceso limpiarEsquinaFlores(ES total:numero)
  comenzar
    mientras HayFlorEnLaEsquina
      tomarFlor
      total:= total + 1
  fin
 
  proceso limpiarEsquinaPapeles(ES total:numero)
  comenzar
    mientras HayPapelEnLaEsquina
      tomarPapel
      total:= total + 1
  fin
 
  proceso avanzarBloqueando(E repeticiones:numero)
  variables
    ca:numero
    av:numero
  comenzar
    repetir repeticiones
      av:= PosAv + 1
      ca:= PosCa
      BloquearEsquina(av, PosCa)
      mover
      {lo que quieras q haga}
      av:= av - 2
      LiberarEsquina(av,ca)
  fin
 
  proceso asignarID
  comenzar
    EnviarMensaje(1,bot1)
    EnviarMensaje(2,bot2)
    EnviarMensaje(3,bot3)
  fin
 
  proceso enviarATodos(E mensaje:numero)
  comenzar
    EnviarMensaje(mensaje,bot1)
    EnviarMensaje(mensaje,bot2)
    EnviarMensaje(mensaje,bot3)
  fin
 
  proceso recibirDeTodos(ES mensaje1:numero; ES mensaje2:numero;ES mensaje3:numero)
  comenzar
    RecibirMensaje(mensaje1,bot1)
    RecibirMensaje(mensaje1,bot1)
    RecibirMensaje(mensaje1,bot1)
  fin
 
  proceso recorrerAvenida(E numAv: numero)
  comenzar
    Pos(numAv, 1)
    repetir 99
      mover
  fin

  proceso recibirFlores(ES floresTot:numero)
  variables
    flores:numero
  comenzar
    RecibirMensaje(flores,bot1)
    floresTot:=floresTot + flores
    RecibirMensaje(flores,bot2)
    floresTot:=floresTot + flores
    RecibirMensaje(flores,bot3)
    floresTot:=floresTot + flores
  fin
 
  proceso depositar(E flores:numero)
  variables
    repes:numero
    av,ca:numero
  comenzar
    repes:=flores
    av:=PosAv
    ca:=PosCa
    repetir repes
      BloquearEsquina(10,10)
      Pos(10,10)
      depositarFlor
      Pos(av,ca)
      LiberarEsquina(10,10)
  fin
 
  proceso enviarData(E ID:numero;E ca:numero;E av:numero)
  comenzar
    si ID = 1
      EnviarMensaje(ca,bot1)
      EnviarMensaje(av,bot1)
      EnviarMensaje(100,bot2)
      EnviarMensaje(100,bot3)
    sino
      si ID = 2
        EnviarMensaje(ca,bot2)
        EnviarMensaje(av,bot2)
        EnviarMensaje(100,bot1)
        EnviarMensaje(100,bot3)
 
      sino
        si ID = 3
          EnviarMensaje(ca,bot3)
          EnviarMensaje(av,bot3)
          EnviarMensaje(100,bot1)
          EnviarMensaje(100,bot2)
  fin
 
  proceso accionar(ES flores:numero)
  variables
    ca,av:numero
    caO,avO:numero
  comenzar
    caO := PosCa
    avO := PosAv
    RecibirMensaje(ca,admin)
    si (ca <> 100)
      RecibirMensaje(av,admin)
      BloquearEsquina(av,ca)
      Pos(av,ca)
      limpiarEsquina(flores)
      Pos(avO,caO)
      LiberarEsquina(av,ca)
  fin

proceso nivelador(E ID:numero)
  variables
    ACK: boolean
  comenzar
    si (ID = 1)
      EnviarMensaje(V,bot2)
      EnviarMensaje(V,bot3)
      RecibirMensaje(ACK,bot2)
      RecibirMensaje(ACK,bot3)
 
    si (ID = 2)
      EnviarMensaje(V,bot1)
      EnviarMensaje(V,bot3)
      RecibirMensaje(ACK,bot1)
      RecibirMensaje(ACK,bot3)
 
    si (ID = 3)
      EnviarMensaje(V,bot1)
      EnviarMensaje(V,bot2)
      RecibirMensaje(ACK,bot1)
      RecibirMensaje(ACK,bot2)
  fin
 proceso etapa(E cant:numero)
  variables
    flores:numero
    avO,caO:numero
    repes:numero
  comenzar
    limpiarEsquina(flores)
    repetir cant
      limpiarEsquina(flores)
      mover
    avO := PosAv
    caO := PosCa
    repes:=flores
    repetir repes
      BloquearEsquina(50,50)
      Pos(50,50)
      depositarFlor
      flores:= flores -1
      Pos(avO,caO)
      LiberarEsquina(50,50)
  fin


declaracion de areas

  areas
    ciudad: AreaC (1,1,100,100)
    area1: AreaP(2,2,2,2)
    area2: AreaP(3,3,3,3)
    area3: AreaP(4,4,4,4)
    HQ: AreaP(1,1,1,1)

caso feo de 13 areas

areas
  areaR1: AreaP (2,1,2,98)
  areaR1.2: AreaP(2,100,2,100)

  areaR2: AreaP(3,1,3,98)
  areaR2.2: AreaP(3,100,3,100)

  areaA1: AreaP(1,98,100,98)
  areaA1.2: AreaP(100,98,100,98)

  areaA2: AreaP(1,99,100,99)
  areaA2.2: AreaP(100,98,100,98)

  areaIntersec1: AreaPC (2,98,2,98)
  areaIntersec2: AreaPC (2,99,2,99)
  areaIntersec3: AreaPC (3,98,3,98)
  areaIntersec4: AreaPC (3,99,3,99)

  HQ: AreaP(1,1,1,1)
robots

variables
  R1: equipoRojo
  R2: equipoRojo
  A1: equipoAzul
  A2: equipoAzul
  admin: fiscalizador
comenzar
  AsignarArea(R1, areaR1)
  AsignarArea(R1, areaR1.2)
  AsignarArea(R1, areaIntersec1)
  AsignarArea(R1, areaIntersec2)
  AsignarArea(R2, areaR2)
  AsignarArea(R2, areaR2.2)
  AsignarArea(R1, areaIntersec3)
  AsignarArea(R1, areaIntersec4)
  AsignarArea(A1, areaA1)
  AsignarArea(A1, areaA1.2)
  AsignarArea(R1, areaIntersec1)
  AsignarArea(R1, areaIntersec3)
  AsignarArea(A2, areaA2)
  AsignarArea(A2, areaA2.2)
  AsignarArea(R1, areaIntersec2)
  AsignarArea(R1, areaIntersec4)
  AsignarArea(admin, HQ)

  Iniciar(R1, 2,1)
  Iniciar(R2, 3,1)
  Iniciar(A1, 100,98)
  Iniciar(A2, 100,99)
  Iniciar(admin, 1,1)
fin


declaracion robot

  robots
    robot robot1
    comenzar
      recorrerAvenida(1)
    fin
    robot admin
    comenzar
      recorreAvenida(1)
    fin
  variables
    bot1: robot1
    bot2: robot1
    bot3: robot1
    admin:admin
  comenzar
    AsignarArea(bot1, area1)
    AsignarArea(bot2, area2)
    AsignarArea(bot3, area3)
    AsignarArea(admin, HQ)
    Iniciar(bot1, 2,2)
    Iniciar(bot2, 3,3)
    Iniciar(bot3, 4,4)
    Iniciar(admin, 1,1)
  fin